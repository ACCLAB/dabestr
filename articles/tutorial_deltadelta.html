<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Tutorial: Delta-Delta • dabestr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Tutorial: Delta-Delta">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">dabestr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2025.3.14</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/plot_aesthetics.html">Controlling Plot Aesthetics</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Tutorials</h6></li>
    <li><a class="dropdown-item" href="../articles/tutorial_basics.html">Tutorial: Basics</a></li>
    <li><a class="dropdown-item" href="../articles/tutorial_repeated_measures.html">Tutorial: Repeated Measures</a></li>
    <li><a class="dropdown-item" href="../articles/tutorial_proportion_plots.html">Tutorial: Proportion Plots</a></li>
    <li><a class="dropdown-item" href="../articles/tutorial_minimeta.html">Tutorial: Mini-Meta Delta</a></li>
    <li><a class="dropdown-item" href="../articles/tutorial_deltadelta.html">Tutorial: Delta-Delta</a></li>
    <li><a class="dropdown-item" href="../articles/sample_datasets.html">Sample Datasets</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ACCLAB/dabestr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<script src="tutorial_deltadelta_files/kePrint-0.0.1/kePrint.js"></script><link href="tutorial_deltadelta_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Tutorial: Delta-Delta</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ACCLAB/dabestr/blob/master/vignettes/tutorial_deltadelta.Rmd" class="external-link"><code>vignettes/tutorial_deltadelta.Rmd</code></a></small>
      <div class="d-none name"><code>tutorial_deltadelta.Rmd</code></div>
    </div>

    
    
<p>This vignette documents how <code>dabestr</code> is able to compute
the calculation of delta-delta, an experimental function that allows the
comparison between two bootstrapped effect sizes computed from two
independent categorical variables.</p>
<p>Many experimental designs investigate the effects of two interacting
independent variables on a dependent variable. The delta-delta effect
size lets us distill the net effect of the two variables. To illustrate
this, let’s delve into the following problem…</p>
<blockquote>
<p>Consider an experiment where we test the efficacy of a drug named
<code>Drug</code> on a disease-causing mutation <code>M</code> based on
a disease metric <code>Y</code>. In this experiment, the greater the
value <code>Y</code>is, the more severe the disease phenotype is. The
phenotype <code>Y</code> has been shown to be caused by a gain of the
function mutation <code>M</code>, so we expect a difference between the
wild type (<code>W</code>) subjects and the mutant subjects
(<code>M</code>). We want to know whether this effect is ameliorated by
the administration of a <code>Drug</code> treatment. We also administer
a placebo as a control. In theory, we only expect the <code>Drug</code>
to have an effect on the <code>M</code> group, although in practice,
many drugs have non-specific effects on healthy populations as well.</p>
</blockquote>
<p>Effectively, we have 4 groups of subjects for comparison:</p>
<table class="table">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
Wild type
</th>
<th style="text-align:left;">
Mutant
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;border-right:1px solid;">
Drug
</td>
<td style="text-align:left;border-right:1px solid;">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mi>D</mi></msub><mo>,</mo><mi>W</mi></mrow><annotation encoding="application/x-tex">X_D, W</annotation></semantics></math>
</td>
<td style="text-align:left;">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mi>D</mi></msub><mo>,</mo><mi>M</mi></mrow><annotation encoding="application/x-tex">X_D, M</annotation></semantics></math>
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;border-right:1px solid;">
Placebo
</td>
<td style="text-align:left;border-right:1px solid;">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mi>P</mi></msub><mo>,</mo><mi>W</mi></mrow><annotation encoding="application/x-tex">X_P, W</annotation></semantics></math>
</td>
<td style="text-align:left;">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mi>P</mi></msub><mo>,</mo><mi>M</mi></mrow><annotation encoding="application/x-tex">X_P, M</annotation></semantics></math>
</td>
</tr>
</tbody>
</table>
<p>There are 2 <code>Treatment</code> conditions: the
<code>Placebo</code> (control group) and the <code>Drug</code> (test
group). There are 2 <code>Genotypes</code>: <code>W</code> (wild type
population) and <code>M</code> (mutant population). Additionally, each
experiment was conducted twice (<code>Rep1</code> and
<code>Rep2</code>). We will perform a few analyses to visualise these
differences in a simulated dataset.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ACCLAB/dabestr" class="external-link">dabestr</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="create-dataset-for-demo">Create dataset for demo<a class="anchor" aria-label="anchor" href="#create-dataset-for-demo"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">12345</span><span class="op">)</span> <span class="co"># Fix the seed so the results are reproducible.</span></span>
<span><span class="co"># pop_size = 10000 # Size of each population.</span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">20</span> <span class="co"># The number of samples taken from each population</span></span>
<span></span>
<span><span class="co"># Create samples</span></span>
<span><span class="va">placebo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">N</span> <span class="op">/</span> <span class="fl">2</span>, mean <span class="op">=</span> <span class="fl">4</span>, sd <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span></span>
<span><span class="va">placebo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">placebo</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">N</span> <span class="op">/</span> <span class="fl">2</span>, mean <span class="op">=</span> <span class="fl">2.8</span>, sd <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">drug</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">N</span> <span class="op">/</span> <span class="fl">2</span>, mean <span class="op">=</span> <span class="fl">3</span>, sd <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span></span>
<span><span class="va">drug</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">drug</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">N</span> <span class="op">/</span> <span class="fl">2</span>, mean <span class="op">=</span> <span class="fl">2.5</span>, sd <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add a `Genotype` column as the second variable</span></span>
<span><span class="va">genotype</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"M"</span>, <span class="va">N</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"W"</span>, <span class="va">N</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add an `id` column for paired data plotting.</span></span>
<span><span class="va">id</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="va">N</span></span>
<span></span>
<span><span class="co"># Add a `Rep` column as the first variable for the 2 replicates of experiments done</span></span>
<span><span class="va">Rep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Rep1"</span>, <span class="st">"Rep2"</span><span class="op">)</span>, <span class="va">N</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine all columns into a DataFrame.</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  Placebo <span class="op">=</span> <span class="va">placebo</span>,</span>
<span>  Drug <span class="op">=</span> <span class="va">drug</span>,</span>
<span>  Genotype <span class="op">=</span> <span class="va">genotype</span>,</span>
<span>  ID <span class="op">=</span> <span class="va">id</span>,</span>
<span>  Rep <span class="op">=</span> <span class="va">Rep</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html" class="external-link">gather</a></span><span class="op">(</span>key <span class="op">=</span> <span class="va">Treatment</span>, value <span class="op">=</span> <span class="va">Measurement</span>, <span class="op">-</span><span class="va">ID</span>, <span class="op">-</span><span class="va">Genotype</span>, <span class="op">-</span><span class="va">Rep</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Genotype</th>
<th align="right">ID</th>
<th align="left">Rep</th>
<th align="left">Treatment</th>
<th align="right">Measurement</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">M</td>
<td align="right">1</td>
<td align="left">Rep1</td>
<td align="left">Placebo</td>
<td align="right">4.234211</td>
</tr>
<tr class="even">
<td align="left">M</td>
<td align="right">2</td>
<td align="left">Rep2</td>
<td align="left">Placebo</td>
<td align="right">4.283786</td>
</tr>
<tr class="odd">
<td align="left">M</td>
<td align="right">3</td>
<td align="left">Rep1</td>
<td align="left">Placebo</td>
<td align="right">3.956279</td>
</tr>
<tr class="even">
<td align="left">M</td>
<td align="right">4</td>
<td align="left">Rep2</td>
<td align="left">Placebo</td>
<td align="right">3.818601</td>
</tr>
<tr class="odd">
<td align="left">M</td>
<td align="right">5</td>
<td align="left">Rep1</td>
<td align="left">Placebo</td>
<td align="right">4.242355</td>
</tr>
<tr class="even">
<td align="left">M</td>
<td align="right">6</td>
<td align="left">Rep2</td>
<td align="left">Placebo</td>
<td align="right">3.272818</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="loading-data">Loading Data<a class="anchor" aria-label="anchor" href="#loading-data"></a>
</h2>
<p>To make a delta-delta plot, you need to simply set
<code>delta2 = TRUE</code> in the <code><a href="../reference/load.html">load()</a></code> function. The
<code>colour</code> parameter will be used to determine the colour of
dots for the scattered plots or the colour of lines for the slopegraphs.
The <code>experiment</code> parameter will be used to specify the
grouping of the data. For delta-delta plots, the <code>idx</code>
parameter is optional. Here’s an example:</p>
</div>
<div class="section level2">
<h2 id="unpaired-data">Unpaired Data<a class="anchor" aria-label="anchor" href="#unpaired-data"></a>
</h2>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">unpaired_delta2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load.html">load</a></span><span class="op">(</span><span class="va">df</span>,</span>
<span>  x <span class="op">=</span> <span class="va">Genotype</span>, y <span class="op">=</span> <span class="va">Measurement</span>,</span>
<span>  experiment <span class="op">=</span> <span class="va">Treatment</span>, colour <span class="op">=</span> <span class="va">Genotype</span>,</span>
<span>  delta2 <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The above function creates the following <code>dabest</code>
object:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">unpaired_delta2</span><span class="op">)</span></span>
<span><span class="co">#&gt; DABESTR v2025.3.14</span></span>
<span><span class="co">#&gt; ==================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Good morning!</span></span>
<span><span class="co">#&gt; The current time is 08:45 AM on Monday September 15, 2025.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ffect size(s) with 95% confidence intervals will be computed for:</span></span>
<span><span class="co">#&gt; 1. M Placebo minus W Placebo</span></span>
<span><span class="co">#&gt; 2. M Drug minus W Drug</span></span>
<span><span class="co">#&gt; 3. Drug minus Placebo (only for mean difference)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; 5000 resamples will be used to generate the effect size bootstraps.</span></span></code></pre></div>
<p>We can quickly check out the effect sizes:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">unpaired_delta2.mean_diff</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/effect_size.html">mean_diff</a></span><span class="op">(</span><span class="va">unpaired_delta2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">unpaired_delta2.mean_diff</span><span class="op">)</span></span>
<span><span class="co">#&gt; DABESTR v2025.3.14</span></span>
<span><span class="co">#&gt; ==================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Good morning!</span></span>
<span><span class="co">#&gt; The current time is 08:45 AM on Monday September 15, 2025.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The character(0) mean difference between M Placebo and W Placebo is 1.032 [95%CI 0.731, 1.279].</span></span>
<span><span class="co">#&gt; The p-value of the two-sided permutation t-test is 0.0000, calculated for legacy purposes only.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The character(0) mean difference between M Drug and W Drug is 0.244 [95%CI -0.136, 0.666].</span></span>
<span><span class="co">#&gt; The p-value of the two-sided permutation t-test is 0.2695, calculated for legacy purposes only.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; 5000 bootstrap samples were taken; the confidence interval is bias-corrected and accelerated.</span></span>
<span><span class="co">#&gt; Any p-value reported is the probability of observing the effect size (or greater),</span></span>
<span><span class="co">#&gt; assuming the null hypothesis of zero difference is true.</span></span>
<span><span class="co">#&gt; For each p-value, 5000 reshuffles of the control and test labels were performed.</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dabest_plot.html">dabest_plot</a></span><span class="op">(</span><span class="va">unpaired_delta2.mean_diff</span><span class="op">)</span></span></code></pre></div>
<p><img src="tutorial_deltadelta_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<p>The horizontal axis in the above plot represents the
<code>Genotype</code> condition, and the dot colour is also specified by
<code>Genotype</code>. The left pair of scattered plots corresponds to
the <code>Placebo</code> group, while the right pair is based on the
<code>Drug</code> group. The bottom left axis contains the two primary
deltas: the <code>Placebo</code> delta and the <code>Drug</code>
delta.</p>
<p>It is evident that when only the placebo was administered, the mutant
phenotype was around 1.23 [95% CI: 0.948, 1.52]. However, this
difference was reduced to approximately 0.326 [95% CI: 0.0934, 0.584]
when the drug was administered, indicating that the drug is effective in
ameliorating the disease phenotype. Since the <code>Drug</code> did not
completely eliminate the mutant phenotype, we need to calculate the net
effect of the drug.</p>
<p>Delta-delta comes in handy in this situation. We use the
<code>Placebo</code> delta as a reference for how much the mutant
phenotype is supposed to be, and we subtract the <code>Drug</code> delta
from it. The bootstrapped mean differences (delta-delta) between the
<code>Placebo</code> and <code>Drug</code> group are plotted at the
bottom right with a separate y-axis from other bootstrap plots. This
effect size, at about -0.903 [95% CI: -1.28, -0.513], represents the net
effect size of the drug treatment. In other words, treatment with drug A
reduced the disease phenotype by 0.903.</p>
<p>The mean difference between mutants and wild types given the placebo
treatment is:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Δ</mi><mn>1</mn></msub><mo>=</mo><msub><mover><mi>X</mi><mo accent="true">‾</mo></mover><mrow><mi>P</mi><mo>,</mo><mi>M</mi></mrow></msub><mo>−</mo><msub><mover><mi>X</mi><mo accent="true">‾</mo></mover><mrow><mi>P</mi><mo>,</mo><mi>W</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\Delta_1 = \bar{X}_{P,M}-\bar{X}_{P,W}</annotation></semantics></math></p>
<p>The mean difference between mutants and wild types given the drug
treatment is:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Δ</mi><mn>2</mn></msub><mo>=</mo><msub><mover><mi>X</mi><mo accent="true">‾</mo></mover><mrow><mi>D</mi><mo>,</mo><mi>M</mi></mrow></msub><mo>−</mo><msub><mover><mi>X</mi><mo accent="true">‾</mo></mover><mrow><mi>D</mi><mo>,</mo><mi>W</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\Delta_2 = \bar{X}_{D,M}-\bar{X}_{D,W}</annotation></semantics></math>
The net effect of the drug on mutants is:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Δ</mi><mi>Δ</mi></msub><mo>=</mo><msub><mi>Δ</mi><mn>1</mn></msub><mo>−</mo><msub><mi>Δ</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\Delta_\Delta = \Delta_1 - \Delta_2</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>X</mi><mo accent="true">‾</mo></mover><annotation encoding="application/x-tex">\bar{X}</annotation></semantics></math>
is the sample mean,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Δ</mi><annotation encoding="application/x-tex">\Delta</annotation></semantics></math>
is the mean difference.</p>
</div>
<div class="section level2">
<h2 id="specifying-grouping-for-comparisons">Specifying Grouping for Comparisons<a class="anchor" aria-label="anchor" href="#specifying-grouping-for-comparisons"></a>
</h2>
<p>In the example above, we used the convention of “test - control’ but
you can manipulate the orders of experiment groups as well as the
horizontal axis variable by setting <code>experiment_label</code> and
<code>x1_level</code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">unpaired_delta2_specified.mean_diff</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load.html">load</a></span><span class="op">(</span><span class="va">df</span>,</span>
<span>  x <span class="op">=</span> <span class="va">Genotype</span>, y <span class="op">=</span> <span class="va">Measurement</span>,</span>
<span>  experiment <span class="op">=</span> <span class="va">Treatment</span>, colour <span class="op">=</span> <span class="va">Genotype</span>,</span>
<span>  delta2 <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  experiment_label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Drug"</span>, <span class="st">"Placebo"</span><span class="op">)</span>,</span>
<span>  x1_level <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"M"</span>, <span class="st">"W"</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/effect_size.html">mean_diff</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/dabest_plot.html">dabest_plot</a></span><span class="op">(</span><span class="va">unpaired_delta2_specified.mean_diff</span><span class="op">)</span></span></code></pre></div>
<p><img src="tutorial_deltadelta_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="paired-data">Paired Data<a class="anchor" aria-label="anchor" href="#paired-data"></a>
</h2>
<p>The <code>delta-delta</code> function also supports paired data,
which can be useful for visualizing the data in an alternative way. If
the placebo and drug treatment were administered to the same subjects,
our data is paired between the treatment conditions. We can specify this
by using <code>Treatment</code> as <code>x</code> and
<code>Genotype</code> as <code>experiment</code>. Additionally, we can
link data from the same subject with each other by specifying
<code>ID</code> as <code>id_col</code>.</p>
<p>Since we have conducted two replicates of the experiments, we can
colour the slope lines according to <code>Rep</code> to differentiate
between the replicates.</p>
<p>Although <code>idx</code> is an optional parameter, it can still be
included as an input to adjust the order of the data as opposed to using
<code>experiment_label</code> and <code>x1_level</code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">paired_delta2.mean_diff</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load.html">load</a></span><span class="op">(</span><span class="va">df</span>,</span>
<span>  x <span class="op">=</span> <span class="va">Treatment</span>, y <span class="op">=</span> <span class="va">Measurement</span>,</span>
<span>  experiment <span class="op">=</span> <span class="va">Genotype</span>, colour <span class="op">=</span> <span class="va">Rep</span>,</span>
<span>  delta2 <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  idx <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Placebo W"</span>, <span class="st">"Drug W"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Placebo M"</span>, <span class="st">"Drug M"</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  paired <span class="op">=</span> <span class="st">"baseline"</span>, id_col <span class="op">=</span> <span class="va">ID</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/effect_size.html">mean_diff</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/dabest_plot.html">dabest_plot</a></span><span class="op">(</span><span class="va">paired_delta2.mean_diff</span>,</span>
<span>  raw_marker_size <span class="op">=</span> <span class="fl">0.5</span>, raw_marker_alpha <span class="op">=</span> <span class="fl">0.3</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="tutorial_deltadelta_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<p>We see that the drug had a non-specific effect of -0.125 [95%CI
-0.486 , 0.214] on the wild type subjects even when they were not sick,
and it had a bigger effect of -0.913 [95%CI -1.24 , -0.577] in the
mutant subjects. In this visualisation, we can see the delta-delta value
of -0.789 [95%CI -1.3 , -0.317] as the net effect of the drug accounting
for non-specific actions in healthy individuals.</p>
<p>The mean difference between drug and placebo treatments in wild type
subjects is:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Δ</mi><mn>1</mn></msub><mo>=</mo><msub><mover><mi>X</mi><mo accent="true">‾</mo></mover><mrow><mi>D</mi><mo>,</mo><mi>M</mi></mrow></msub><mo>−</mo><msub><mover><mi>X</mi><mo accent="true">‾</mo></mover><mrow><mi>P</mi><mo>,</mo><mi>W</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\Delta_1 = \bar{X}_{D,M}-\bar{X}_{P,W}</annotation></semantics></math></p>
<p>The mean difference between drug and placebo treatments in mutant
subjects is:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Δ</mi><mn>2</mn></msub><mo>=</mo><msub><mover><mi>X</mi><mo accent="true">‾</mo></mover><mrow><mi>D</mi><mo>,</mo><mi>M</mi></mrow></msub><mo>−</mo><msub><mover><mi>X</mi><mo accent="true">‾</mo></mover><mrow><mi>P</mi><mo>,</mo><mi>W</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\Delta_2 = \bar{X}_{D,M}-\bar{X}_{P,W}</annotation></semantics></math>
The net effect of the drug on mutants is:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Δ</mi><mi>Δ</mi></msub><mo>=</mo><msub><mi>Δ</mi><mn>2</mn></msub><mo>−</mo><msub><mi>Δ</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\Delta_\Delta = \Delta_2 - \Delta_1</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>X</mi><mo accent="true">‾</mo></mover><annotation encoding="application/x-tex">\bar{X}</annotation></semantics></math>
is the sample mean,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Δ</mi><annotation encoding="application/x-tex">\Delta</annotation></semantics></math>
is the mean difference.</p>
</div>
<div class="section level2">
<h2 id="connection-to-anova">Connection to ANOVA<a class="anchor" aria-label="anchor" href="#connection-to-anova"></a>
</h2>
<p>The comparison we conducted earlier is reminiscent of a two-way
ANOVA. In fact, the delta-delta is an effect size estimated for the
interaction term between <code>Treatment</code> and
<code>Genotype</code>. On the other hand, main effects of
<code>Treatment</code> and <code>Genotype</code> can be determined
through simpler, univariate contrast plots.</p>
</div>
<div class="section level2">
<h2 id="omitting-delta-delta-plot">Omitting Delta-delta Plot<a class="anchor" aria-label="anchor" href="#omitting-delta-delta-plot"></a>
</h2>
<p>If for some reason you don’t want to display the delta-delta plot,
you can easily do so by setting <code>show_delta2</code> to FALSE:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dabest_plot.html">dabest_plot</a></span><span class="op">(</span><span class="va">unpaired_delta2.mean_diff</span>, show_delta2 <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="tutorial_deltadelta_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="other-effect-sizes">Other Effect Sizes<a class="anchor" aria-label="anchor" href="#other-effect-sizes"></a>
</h2>
<p>Since the delta-delta function is only applicable to mean
differences, plots of other effect sizes will not include a delta-delta
bootstrap plot.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># cohens_d(unpaired_delta2)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="statistics">Statistics<a class="anchor" aria-label="anchor" href="#statistics"></a>
</h2>
<p>You can find all the outputs of the delta - delta calculation by
assessing the column named <code>boot_result</code> of the object
<code>dabest_effectsize_obj</code>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">unpaired_delta2.mean_diff</span><span class="op">$</span><span class="va">boot_result</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 11</span></span></span>
<span><span class="co">#&gt;   control_group   test_group bootstraps nboots bca_ci_low bca_ci_high pct_ci_low</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> W Placebo       M Placebo  <span style="color: #949494;">&lt;dbl&gt;</span>        <span style="text-decoration: underline;">5</span>000      0.731       1.28       0.748</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> W Drug          M Drug     <span style="color: #949494;">&lt;dbl&gt;</span>        <span style="text-decoration: underline;">5</span>000     -<span style="color: #BB0000;">0.136</span>       0.666     -<span style="color: #BB0000;">0.151</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Delta2 Overall… Delta2 Ov… <span style="color: #949494;">&lt;dbl&gt;</span>        <span style="text-decoration: underline;">5</span>000     -<span style="color: #BB0000;">1.20</span>       -<span style="color: #BB0000;">0.337</span>     -<span style="color: #BB0000;">0.799</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 4 more variables: pct_ci_high &lt;dbl&gt;, ci &lt;dbl&gt;, difference &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   weight &lt;dbl&gt;</span></span></span></code></pre></div>
<p>If you want to extract the permutations, permutation test’s p values,
the statistical tests and the p value results, you can access them using
the columns <code>permutation_test_results</code>,
<code>pval_permtest</code>, <code>pval_for_tests</code> and
<code>pvalues</code> respectively.</p>
<p>For instance, the P values for permutation tests
<code>pval_permtest</code>:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">unpaired_delta2.mean_diff</span><span class="op">$</span><span class="va">permtest_pvals</span><span class="op">$</span><span class="va">pval_permtest</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.0000 0.2628</span></span></code></pre></div>
<p>Or the permutation calculations and results could be accessed by:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">unpaired_delta2.mean_diff</span><span class="op">$</span><span class="va">permtest_pvals</span><span class="op">$</span><span class="va">permutation_test_results</span><span class="op">)</span></span></code></pre></div>
<p>A representative <em>p value</em> for statistical tests
<code>pval_for_tests</code>:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">unpaired_delta2.mean_diff</span><span class="op">$</span><span class="va">permtest_pvals</span><span class="op">$</span><span class="va">pval_for_tests</span><span class="op">)</span></span>
<span><span class="co">#&gt; $pvalue_welch</span></span>
<span><span class="co">#&gt; [1] 1.650881e-06</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $pvalue_welch</span></span>
<span><span class="co">#&gt; [1] 0.2694873</span></span></code></pre></div>
<p>Finally here the statistical test results and
<code>pvalues</code>:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">unpaired_delta2.mean_diff</span><span class="op">$</span><span class="va">permtest_pvals</span><span class="op">$</span><span class="va">pvalues</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; [[1]]$pvalue_welch</span></span>
<span><span class="co">#&gt; [1] 1.650881e-06</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[1]]$statistic_welch</span></span>
<span><span class="co">#&gt;         t </span></span>
<span><span class="co">#&gt; -6.971633 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[1]]$students_t</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Welch Two Sample t-test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  control and test</span></span>
<span><span class="co">#&gt; t = -6.9716, df = 17.979, p-value = 1.651e-06</span></span>
<span><span class="co">#&gt; alternative hypothesis: true difference in means is not equal to 0</span></span>
<span><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span><span class="co">#&gt;  -1.3435832 -0.7212793</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt; mean of x mean of y </span></span>
<span><span class="co">#&gt;  2.914391  3.946822 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[1]]$pvalue_students_t</span></span>
<span><span class="co">#&gt; [1] 1.650881e-06</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[1]]$statistic_students_t</span></span>
<span><span class="co">#&gt;         t </span></span>
<span><span class="co">#&gt; -6.971633 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[1]]$pvalue_mann_whitney</span></span>
<span><span class="co">#&gt; [1] 0.0002461281</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[1]]$statistic_mann_whitney</span></span>
<span><span class="co">#&gt; W </span></span>
<span><span class="co">#&gt; 1 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt; [[2]]$pvalue_welch</span></span>
<span><span class="co">#&gt; [1] 0.2694873</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]$statistic_welch</span></span>
<span><span class="co">#&gt;         t </span></span>
<span><span class="co">#&gt; -1.139429 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]$students_t</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Welch Two Sample t-test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  control and test</span></span>
<span><span class="co">#&gt; t = -1.1394, df = 17.968, p-value = 0.2695</span></span>
<span><span class="co">#&gt; alternative hypothesis: true difference in means is not equal to 0</span></span>
<span><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span><span class="co">#&gt;  -0.6928931  0.2056392</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt; mean of x mean of y </span></span>
<span><span class="co">#&gt;  2.789728  3.033355 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]$pvalue_students_t</span></span>
<span><span class="co">#&gt; [1] 0.2694873</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]$statistic_students_t</span></span>
<span><span class="co">#&gt;         t </span></span>
<span><span class="co">#&gt; -1.139429 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]$pvalue_mann_whitney</span></span>
<span><span class="co">#&gt; [1] 0.3447042</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]$statistic_mann_whitney</span></span>
<span><span class="co">#&gt;  W </span></span>
<span><span class="co">#&gt; 37</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Joses W. Ho, <a href="https://github.com/sunroofgod" class="external-link">Kah Seng Lian</a>, Ana Rosa Castillo, Zhuoyu Wang, <a href="https://github.com/junyangliao" class="external-link">Jun Yang Liao</a>, Felicia Low, Tayfun Tumkaya, Jonathan Anns, Yishan Mai, Sangyu Xu, Hyungwon Choi, Adam Claridge-Chang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
